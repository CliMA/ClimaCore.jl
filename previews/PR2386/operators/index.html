<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Operators ¬∑ ClimaCore.jl</title><meta name="title" content="Operators ¬∑ ClimaCore.jl"/><meta property="og:title" content="Operators ¬∑ ClimaCore.jl"/><meta property="twitter:title" content="Operators ¬∑ ClimaCore.jl"/><meta name="description" content="Documentation for ClimaCore.jl."/><meta property="og:description" content="Documentation for ClimaCore.jl."/><meta property="twitter:description" content="Documentation for ClimaCore.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ClimaCore.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaCore.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../math_framework/">Mathematical Framework</a></li><li><a class="tocitem" href="../installation_instructions/">Installation and How-to Guides</a></li><li><a class="tocitem" href="../geometry/">Geometry</a></li><li class="is-active"><a class="tocitem" href>Operators</a><ul class="internal"><li><a class="tocitem" href="#Spectral-element-operators"><span>Spectral element operators</span></a></li><li><a class="tocitem" href="#Finite-difference-operators"><span>Finite difference operators</span></a></li><li><a class="tocitem" href="#Finite-difference-boundary-conditions"><span>Finite difference boundary conditions</span></a></li><li><a class="tocitem" href="#Integrals"><span>Integrals</span></a></li><li><a class="tocitem" href="#Internal-APIs"><span>Internal APIs</span></a></li></ul></li><li><a class="tocitem" href="../remapping/">Remapping</a></li><li><a class="tocitem" href="../matrix_fields/">MatrixFields</a></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../APIs/utilities_api/">Utilities</a></li><li><a class="tocitem" href="../APIs/datalayouts_api/">DataLayouts</a></li><li><a class="tocitem" href="../APIs/geometry_api/">Geometry</a></li><li><a class="tocitem" href="../APIs/domains_api/">Domains</a></li><li><a class="tocitem" href="../APIs/meshes_api/">Meshes</a></li><li><a class="tocitem" href="../APIs/topologies_api/">Topologies</a></li><li><a class="tocitem" href="../APIs/grids_api/">Grids</a></li><li><a class="tocitem" href="../APIs/hypso_api/">Hypsography</a></li><li><a class="tocitem" href="../APIs/dss_api/">DSS</a></li><li><a class="tocitem" href="../APIs/common_grids_api/">CommonGrids</a></li><li><a class="tocitem" href="../APIs/spaces_api/">Spaces</a></li><li><a class="tocitem" href="../APIs/common_spaces_api/">CommonSpaces</a></li><li><a class="tocitem" href="../APIs/quadratures_api/">Quadratures</a></li><li><a class="tocitem" href="../APIs/fields_api/">Fields</a></li><li><a class="tocitem" href="../APIs/limiters_api/">Limiters</a></li><li><a class="tocitem" href="../APIs/input_output_api/">InputOutput</a></li><li><a class="tocitem" href="../APIs/remapping_api/">Remapping</a></li><li><a class="tocitem" href="../APIs/recursive_apply_api/">RecursiveApply</a></li><li><a class="tocitem" href="../APIs/devices_api/">Devices</a></li><li><a class="tocitem" href="../APIs/debug_only_api/">DebugOnly</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Developer docs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../performance_tips/">Performance tips</a></li><li><a class="tocitem" href="../shmem_design/">Shared memory design</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../tutorials/introduction/">Introduction to ClimaCore.jl</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../masks/">Masks</a></li><li><a class="tocitem" href="../debugging/">Debugging</a></li><li><input class="collapse-toggle" id="menuitem-15" type="checkbox"/><label class="tocitem" for="menuitem-15"><span class="docs-label">Libraries</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../lib/ClimaCorePlots/">ClimaCorePlots.jl</a></li><li><a class="tocitem" href="../lib/ClimaCoreMakie/">ClimaCoreMakie.jl</a></li><li><a class="tocitem" href="../lib/ClimaCoreVTK/">ClimaCoreVTK.jl</a></li><li><a class="tocitem" href="../lib/ClimaCoreTempestRemap/">ClimaCoreTempestRemap.jl</a></li><li><a class="tocitem" href="../lib/ClimaCoreSpectra/">ClimaCoreSpectra.jl</a></li></ul></li><li><a class="tocitem" href="../Contributing/">Contributing guide</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../faq/">Frequently asked questions</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Operators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaCore.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/ClimaCore.jl/blob/main/docs/src/operators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Operators"><a class="docs-heading-anchor" href="#Operators">Operators</a><a id="Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Operators" title="Permalink"></a></h1><p><em>Operators</em> can compute spatial derivative operations.</p><ul><li>for performance reasons, we need to be able to &quot;fuse&quot; multiple operators and function applications</li><li>Julia provides a tool for this: <strong>broadcasting</strong>, with a very flexible API</li></ul><p>Can think of operators are &quot;pseudo-functions&quot;: can&#39;t be called directly, but act similar to functions in the context of broadcasting. They are matrix-free, in the sense that we define the <em>action</em> of the operator directly on a field, without explicitly assembling the matrix representing the discretized operator.</p><h2 id="Spectral-element-operators"><a class="docs-heading-anchor" href="#Spectral-element-operators">Spectral element operators</a><a id="Spectral-element-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Spectral-element-operators" title="Permalink"></a></h2><h3 id="Differential-Operators"><a class="docs-heading-anchor" href="#Differential-Operators">Differential Operators</a><a id="Differential-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-Operators" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.Gradient" href="#ClimaCore.Operators.Gradient"><code>ClimaCore.Operators.Gradient</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grad = Gradient()
grad.(f)</code></pre><p>Compute the (strong) gradient of <code>f</code> on each element, returning a <code>CovariantVector</code>-field.</p><p>The <span>$i$</span>th covariant component of the gradient is the partial derivative with respect to the reference element:</p><p class="math-container">\[(\nabla f)_i = \frac{\partial f}{\partial \xi^i}\]</p><p>Discretely, this can be written in matrix form as</p><p class="math-container">\[D_i f\]</p><p>where <span>$D_i$</span> is the derivative matrix along the <span>$i$</span>th dimension.</p><p><strong>References</strong></p><ul><li>[<a href="../references/#Taylor2010">1</a>], equation 16</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L726-L747">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.Divergence" href="#ClimaCore.Operators.Divergence"><code>ClimaCore.Operators.Divergence</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">div = Divergence()
div.(u)</code></pre><p>Computes the per-element spectral (strong) divergence of a vector field <span>$u$</span>.</p><p>The divergence of a vector field <span>$u$</span> is defined as</p><p class="math-container">\[\nabla \cdot u = \sum_i \frac{1}{J} \frac{\partial (J u^i)}{\partial \xi^i}\]</p><p>where <span>$J$</span> is the Jacobian determinant, <span>$u^i$</span> is the <span>$i$</span>th contravariant component of <span>$u$</span>.</p><p>This is discretized by</p><p class="math-container">\[\sum_i I \left\{\frac{1}{J} \frac{\partial (I\{J u^i\})}{\partial \xi^i} \right\}\]</p><p>where <span>$I\{x\}$</span> is the interpolation operator that projects to the unique polynomial interpolating <span>$x$</span> at the quadrature points. In matrix form, this can be written as</p><p class="math-container">\[J^{-1} \sum_i D_i J u^i\]</p><p>where <span>$D_i$</span> is the derivative matrix along the <span>$i$</span>th dimension</p><p><strong>References</strong></p><ul><li>[<a href="../references/#Taylor2010">1</a>], equation 15</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L502-L529">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.WeakDivergence" href="#ClimaCore.Operators.WeakDivergence"><code>ClimaCore.Operators.WeakDivergence</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wdiv = WeakDivergence()
wdiv.(u)</code></pre><p>Computes the &quot;weak divergence&quot; of a vector field <code>u</code>.</p><p>This is defined as the scalar field <span>$\theta \in \mathcal{V}_0$</span> such that for all <span>$\phi\in \mathcal{V}_0$</span></p><p class="math-container">\[\int_\Omega \phi \theta \, d \Omega
=
- \int_\Omega (\nabla \phi) \cdot u \,d \Omega\]</p><p>where <span>$\mathcal{V}_0$</span> is the space of <span>$u$</span>.</p><p>This arises as the contribution of the volume integral after by applying integration by parts to the weak form expression of the divergence</p><p class="math-container">\[\int_\Omega \phi (\nabla \cdot u) \, d \Omega
=
- \int_\Omega (\nabla \phi) \cdot u \,d \Omega
+ \oint_{\partial \Omega} \phi (u \cdot n) \,d \sigma\]</p><p>It can be written in matrix form as</p><p class="math-container">\[œï^\top WJ Œ∏ = - \sum_i (D_i œï)^\top WJ u^i\]</p><p>which reduces to</p><p class="math-container">\[Œ∏ = -(WJ)^{-1} \sum_i D_i^\top WJ u^i\]</p><p>where</p><ul><li><span>$J$</span> is the diagonal Jacobian matrix</li><li><span>$W$</span> is the diagonal matrix of quadrature weights</li><li><span>$D_i$</span> is the derivative matrix along the <span>$i$</span>th dimension</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L612-L648">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.WeakGradient" href="#ClimaCore.Operators.WeakGradient"><code>ClimaCore.Operators.WeakGradient</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wgrad = WeakGradient()
wgrad.(f)</code></pre><p>Compute the &quot;weak gradient&quot; of <code>f</code> on each element.</p><p>This is defined as the the vector field <span>$\theta \in \mathcal{V}_0$</span> such that for all <span>$\phi \in \mathcal{V}_0$</span></p><p class="math-container">\[\int_\Omega \phi \cdot \theta \, d \Omega
=
- \int_\Omega (\nabla \cdot \phi) f \, d\Omega\]</p><p>where <span>$\mathcal{V}_0$</span> is the space of <span>$f$</span>.</p><p>This arises from the contribution of the volume integral after by applying integration by parts to the weak form expression of the gradient</p><p class="math-container">\[\int_\Omega \phi \cdot (\nabla f) \, d \Omega
=
- \int_\Omega f (\nabla \cdot \phi) \, d\Omega
+ \oint_{\partial \Omega} f (\phi \cdot n) \, d \sigma\]</p><p>In matrix form, this becomes</p><p class="math-container">\[{\phi^i}^\top W J \theta_i = - ( J^{-1} D_i J \phi^i )^\top W J f\]</p><p>which reduces to</p><p class="math-container">\[\theta_i = -W^{-1} D_i^\top W f\]</p><p>where <span>$D_i$</span> is the derivative matrix along the <span>$i$</span>th dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L805-L838">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.Curl" href="#ClimaCore.Operators.Curl"><code>ClimaCore.Operators.Curl</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">curl = Curl()
curl.(u)</code></pre><p>Computes the per-element spectral (strong) curl of a covariant vector field <span>$u$</span>.</p><p>Note: The vector field <span>$u$</span> needs to be excliclty converted to a <code>CovaraintVector</code>, as then the <code>Curl</code> is independent of the local metric tensor.</p><p>The curl of a vector field <span>$u$</span> is a vector field with contravariant components</p><p class="math-container">\[(\nabla \times u)^i = \frac{1}{J} \sum_{jk} \epsilon^{ijk} \frac{\partial u_k}{\partial \xi^j}\]</p><p>where <span>$J$</span> is the Jacobian determinant, <span>$u_k$</span> is the <span>$k$</span>th covariant component of <span>$u$</span>, and <span>$\epsilon^{ijk}$</span> are the <a href="https://en.wikipedia.org/wiki/Levi-Civita_symbol#Three_dimensions_2">Levi-Civita symbols</a>. In other words</p><p class="math-container">\[\begin{bmatrix}
  (\nabla \times u)^1 \\
  (\nabla \times u)^2 \\
  (\nabla \times u)^3
\end{bmatrix}
=
\frac{1}{J} \begin{bmatrix}
  \frac{\partial u_3}{\partial \xi^2} - \frac{\partial u_2}{\partial \xi^3} \\
  \frac{\partial u_1}{\partial \xi^3} - \frac{\partial u_3}{\partial \xi^1} \\
  \frac{\partial u_2}{\partial \xi^1} - \frac{\partial u_1}{\partial \xi^2}
\end{bmatrix}\]</p><p>In matrix form, this becomes</p><p class="math-container">\[\epsilon^{ijk} J^{-1} D_j u_k\]</p><p>Note that unused dimensions will be dropped: e.g. the 2D curl of a <code>Covariant12Vector</code>-field will return a <code>Contravariant3Vector</code>.</p><p><strong>References</strong></p><ul><li>[<a href="../references/#Taylor2010">1</a>], equation 17</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L909-L949">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.WeakCurl" href="#ClimaCore.Operators.WeakCurl"><code>ClimaCore.Operators.WeakCurl</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wcurl = WeakCurl()
wcurl.(u)</code></pre><p>Computes the &quot;weak curl&quot; on each element of a covariant vector field <code>u</code>.</p><p>Note: The vector field <span>$u$</span> needs to be excliclty converted to a <code>CovaraintVector</code>, as then the <code>WeakCurl</code> is independent of the local metric tensor.</p><p>This is defined as the vector field <span>$\theta \in \mathcal{V}_0$</span> such that for all <span>$\phi \in \mathcal{V}_0$</span></p><p class="math-container">\[\int_\Omega \phi \cdot \theta \, d \Omega
=
\int_\Omega (\nabla \times \phi) \cdot u \,d \Omega\]</p><p>where <span>$\mathcal{V}_0$</span> is the space of <span>$f$</span>.</p><p>This arises from the contribution of the volume integral after by applying integration by parts to the weak form expression of the curl</p><p class="math-container">\[\int_\Omega \phi \cdot (\nabla \times u) \,d\Omega
=
\int_\Omega (\nabla \times \phi) \cdot u \,d \Omega
- \oint_{\partial \Omega} (\phi \times u) \cdot n \,d\sigma\]</p><p>In matrix form, this becomes</p><p class="math-container">\[{\phi_i}^\top W J \theta^i = (J^{-1} \epsilon^{kji} D_j \phi_i)^\top W J u_k\]</p><p>which, by using the anti-symmetry of the Levi-Civita symbol, reduces to</p><p class="math-container">\[\theta^i = - \epsilon^{ijk} (WJ)^{-1} D_j^\top W u_k\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L1102-L1137">source</a></section></article><h3 id="Interpolation-Operators"><a class="docs-heading-anchor" href="#Interpolation-Operators">Interpolation Operators</a><a id="Interpolation-Operators-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolation-Operators" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.Interpolate" href="#ClimaCore.Operators.Interpolate"><code>ClimaCore.Operators.Interpolate</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">i = Interpolate(space)
i.(f)</code></pre><p>Interpolates <code>f</code> to the <code>space</code>. If <code>space</code> has equal or higher polynomial degree as the space of <code>f</code>, this is exact, otherwise it will be lossy.</p><p>In matrix form, it is the linear operator</p><p class="math-container">\[I = \bigotimes_i I_i\]</p><p>where <span>$I_i$</span> is the barycentric interpolation matrix in the <span>$i$</span>th dimension.</p><p>See also <a href="#ClimaCore.Operators.Restrict"><code>Restrict</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L1311-L1325">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.Restrict" href="#ClimaCore.Operators.Restrict"><code>ClimaCore.Operators.Restrict</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">r = Restrict(space)
r.(f)</code></pre><p>Computes the projection of a field <code>f</code> on <span>$\mathcal{V}_0$</span> to a lower degree polynomial space <code>space</code> (<span>$\mathcal{V}_0^*$</span>). <code>space</code> must be on the same topology as the space of <code>f</code>, but have a lower polynomial degree.</p><p>It is defined as the field <span>$\theta \in \mathcal{V}_0^*$</span> such that for all <span>$\phi \in \mathcal{V}_0^*$</span></p><p class="math-container">\[\int_\Omega \phi \theta \,d\Omega = \int_\Omega \phi f \,d\Omega\]</p><p>In matrix form, this is</p><p class="math-container">\[\phi^\top W^* J^* \theta = (I \phi)^\top WJ f\]</p><p>where <span>$W^*$</span> and <span>$J^*$</span> are the quadrature weights and Jacobian determinant of <span>$\mathcal{V}_0^*$</span>, and <span>$I$</span> is the interpolation operator (see <a href="#ClimaCore.Operators.Interpolate"><code>Interpolate</code></a>) from <span>$\mathcal{V}_0^*$</span> to <span>$\mathcal{V}_0$</span>. This reduces to</p><p class="math-container">\[\theta = (W^* J^*)^{-1} I^\top WJ f\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/spectralelement.jl#L1393-L1415">source</a></section></article><h2 id="Finite-difference-operators"><a class="docs-heading-anchor" href="#Finite-difference-operators">Finite difference operators</a><a id="Finite-difference-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-difference-operators" title="Permalink"></a></h2><p>Finite difference operators are similar with some subtle differences:</p><ul><li>they can change staggering (center to face, or vice versa)</li><li>they can span multiple elements<ul><li>no DSS is required</li><li>boundary handling may be required</li></ul></li></ul><p>We use the following convention:</p><ul><li>centers are indexed by integers <code>1, 2, ..., n</code></li><li>faces are indexed by half integers <code>half, 1+half, ..., n+half</code></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.FiniteDifferenceOperator" href="#ClimaCore.Operators.FiniteDifferenceOperator"><code>ClimaCore.Operators.FiniteDifferenceOperator</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FiniteDifferenceOperator</code></pre><p>An abstract type for finite difference operators. Instances of this should define:</p><ul><li><a href="#ClimaCore.Operators.getidx_return_type"><code>getidx_return_type</code></a></li><li><a href="#ClimaCore.Operators.stencil_return_type"><code>stencil_return_type</code></a></li><li><a href="#ClimaCore.Operators.return_eltype"><code>return_eltype</code></a></li><li><a href="#ClimaCore.Operators.return_space"><code>return_space</code></a></li><li><a href="#ClimaCore.Operators.stencil_interior_width"><code>stencil_interior_width</code></a></li><li><a href="#ClimaCore.Operators.stencil_interior"><code>stencil_interior</code></a></li></ul><p>See also <a href="#ClimaCore.Operators.AbstractBoundaryCondition"><code>AbstractBoundaryCondition</code></a> for how to define the boundaries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L165-L178">source</a></section></article><h3 id="Interpolation-operators"><a class="docs-heading-anchor" href="#Interpolation-operators">Interpolation operators</a><a id="Interpolation-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Interpolation-operators" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.InterpolateC2F" href="#ClimaCore.Operators.InterpolateC2F"><code>ClimaCore.Operators.InterpolateC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">I = InterpolateC2F(;boundaries..)
I.(x)</code></pre><p>Interpolate a center-valued field <code>x</code> to faces, using the stencil</p><p class="math-container">\[I(x)[i] = \frac{1}{2} (x[i+\tfrac{1}{2}] + x[i-\tfrac{1}{2}])\]</p><p>Supported boundary conditions are:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: set the value at the boundary face to be <code>x‚ÇÄ</code>. On the left boundary the stencil is</li></ul><p class="math-container">\[I(x)[\tfrac{1}{2}] = x‚ÇÄ\]</p><ul><li><a href="#ClimaCore.Operators.SetGradient"><code>SetGradient(v)</code></a>: set the value at the boundary such that the gradient is <code>v</code>. At the left boundary the stencil is</li></ul><p class="math-container">\[I(x)[\tfrac{1}{2}] = x[1] - \frac{1}{2} v¬≥\]</p><ul><li><a href="#ClimaCore.Operators.Extrapolate"><code>Extrapolate</code></a>: use the closest interior point as the boundary value. At the left boundary the stencil is</li></ul><p class="math-container">\[I(x)[\tfrac{1}{2}] = x[1]\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L444-L470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.InterpolateF2C" href="#ClimaCore.Operators.InterpolateF2C"><code>ClimaCore.Operators.InterpolateF2C</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">InterpolateF2C()</code></pre><p>Interpolate from face to center mesh. No boundary conditions are required (or supported).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L411-L416">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.WeightedInterpolateC2F" href="#ClimaCore.Operators.WeightedInterpolateC2F"><code>ClimaCore.Operators.WeightedInterpolateC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WI = WeightedInterpolateC2F(; boundaries)
WI.(w, x)</code></pre><p>Interpolate a center-valued field <code>x</code> to faces, weighted by a center-valued field <code>w</code>, using the stencil</p><p class="math-container">\[WI(w, x)[i] = \frac{
    w[i+\tfrac{1}{2}] x[i+\tfrac{1}{2}] +  w[i-\tfrac{1}{2}] x[i-\tfrac{1}{2}])
}{
    w[i+\tfrac{1}{2}] + w[i-\tfrac{1}{2}]
}\]</p><p>Supported boundary conditions are:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(val)</code></a>: set the value at the boundary face to be <code>val</code>.</li><li><a href="#ClimaCore.Operators.SetGradient"><code>SetGradient</code></a>: set the value at the boundary such that the gradient is <code>val</code>.</li><li><a href="#ClimaCore.Operators.Extrapolate"><code>Extrapolate</code></a>: use the closest interior point as the boundary value.</li></ul><p>These have the same stencil as in <a href="#ClimaCore.Operators.InterpolateC2F"><code>InterpolateC2F</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L1129-L1150">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.WeightedInterpolateF2C" href="#ClimaCore.Operators.WeightedInterpolateF2C"><code>ClimaCore.Operators.WeightedInterpolateF2C</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WI = WeightedInterpolateF2C(; boundaries)
WI.(w, x)</code></pre><p>Interpolate a face-valued field <code>x</code> to centers, weighted by a face-valued field <code>w</code>, using the stencil</p><p class="math-container">\[WI(w, x)[i] = \frac{
        w[i+\tfrac{1}{2}] x[i+\tfrac{1}{2}] +  w[i-\tfrac{1}{2}] x[i-\tfrac{1}{2}])
    }{
        w[i+\tfrac{1}{2}] + w[i-\tfrac{1}{2}]
    }\]</p><p>No boundary conditions are required (or supported)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L1078-L1093">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.UpwindBiasedProductC2F" href="#ClimaCore.Operators.UpwindBiasedProductC2F"><code>ClimaCore.Operators.UpwindBiasedProductC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">U = UpwindBiasedProductC2F(;boundaries)
U.(v, x)</code></pre><p>Compute the product of the face-valued vector field <code>v</code> and a center-valued field <code>x</code> at cell faces by upwinding <code>x</code> according to the direction of <code>v</code>.</p><p>More precisely, it is computed based on the sign of the 3rd contravariant component, and it returns a <code>Contravariant3Vector</code>:</p><p class="math-container">\[U(\boldsymbol{v},x)[i] = \begin{cases}
  v^3[i] x[i-\tfrac{1}{2}]\boldsymbol{e}_3 \textrm{, if } v^3[i] &gt; 0 \\
  v^3[i] x[i+\tfrac{1}{2}]\boldsymbol{e}_3 \textrm{, if } v^3[i] &lt; 0
  \end{cases}\]</p><p>where <span>$\boldsymbol{e}_3$</span> is the 3rd covariant basis vector.</p><p>Supported boundary conditions are:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: set the value of <code>x</code> to be <code>x‚ÇÄ</code> in a hypothetical ghost cell on the other side of the boundary. On the left boundary the stencil is<p class="math-container">\[U(\boldsymbol{v},x)[\tfrac{1}{2}] = \begin{cases}
  v^3[\tfrac{1}{2}] x_0  \boldsymbol{e}_3 \textrm{, if }  v^3[\tfrac{1}{2}] &gt; 0 \\
  v^3[\tfrac{1}{2}] x[1] \boldsymbol{e}_3 \textrm{, if }  v^3[\tfrac{1}{2}] &lt; 0
  \end{cases}\]</p></li><li><a href="#ClimaCore.Operators.Extrapolate"><code>Extrapolate()</code></a>: set the value of <code>x</code> to be the same as the closest interior point. On the left boundary, the stencil is<p class="math-container">\[U(\boldsymbol{v},x)[\tfrac{1}{2}] = U(\boldsymbol{v},x)[1 + \tfrac{1}{2}]\]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L1279-L1311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.Upwind3rdOrderBiasedProductC2F" href="#ClimaCore.Operators.Upwind3rdOrderBiasedProductC2F"><code>ClimaCore.Operators.Upwind3rdOrderBiasedProductC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">U = Upwind3rdOrderBiasedProductC2F(;boundaries)
U.(v, x)</code></pre><p>Compute the product of a face-valued vector field <code>v</code> and a center-valued field <code>x</code> at cell faces by upwinding <code>x</code>, to third-order of accuracy, according to <code>v</code></p><p class="math-container">\[U(v,x)[i] = \begin{cases}
  v[i] \left(-2 x[i-\tfrac{3}{2}] + 10 x[i-\tfrac{1}{2}] + 4 x[i+\tfrac{1}{2}] \right) / 12  \textrm{, if } v[i] &gt; 0 \\
  v[i] \left(4 x[i-\tfrac{1}{2}] + 10 x[i+\tfrac{1}{2}] -2 x[i+\tfrac{3}{2}]  \right) / 12  \textrm{, if } v[i] &lt; 0
  \end{cases}\]</p><p>This stencil is based on [<a href="../references/#WickerSkamarock2002">2</a>], eq. 4(a).</p><p>Supported boundary conditions are:</p><ul><li><a href="#ClimaCore.Operators.FirstOrderOneSided"><code>FirstOrderOneSided(x‚ÇÄ)</code></a>: uses the first-order downwind scheme to compute <code>x</code> on the left boundary, and the first-order upwind scheme to compute <code>x</code> on the right boundary.</li><li><a href="#ClimaCore.Operators.ThirdOrderOneSided"><code>ThirdOrderOneSided(x‚ÇÄ)</code></a>: uses the third-order downwind reconstruction to compute <code>x</code> on the left boundary, and the third-order upwind reconstruction to compute <code>x</code> on the right boundary.</li></ul><div class="admonition is-info" id="Note-ae65fe238f674ec1"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ae65fe238f674ec1" title="Permalink"></a></header><div class="admonition-body"><p>These boundary conditions do not define the value at the actual boundary faces, and so this operator should not be materialized directly: it needs to be composed with another operator that does not make use of this value, e.g. a <a href="#ClimaCore.Operators.DivergenceF2C"><code>DivergenceF2C</code></a> operator, with a <a href="#ClimaCore.Operators.SetValue"><code>SetValue</code></a> boundary.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L1650-L1678">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.FCTBorisBook" href="#ClimaCore.Operators.FCTBorisBook"><code>ClimaCore.Operators.FCTBorisBook</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">U = FCTBorisBook(;boundaries)
U.(v, x)</code></pre><p>Correct the flux using the flux-corrected transport formulation by Boris and Book [<a href="../references/#BorisBook1973">3</a>].</p><p>Input arguments:</p><ul><li>a face-valued vector field <code>v</code></li><li>a center-valued field <code>x</code></li></ul><p class="math-container">\[Ac(v,x)[i] =
  s[i] \max \left\{0, \min \left[ |v[i] |, s[i] \left( x[i+\tfrac{3}{2}] - x[i+\tfrac{1}{2}]  \right) ,  s[i] \left( x[i-\tfrac{1}{2}] - x[i-\tfrac{3}{2}]  \right) \right] \right\},\]</p><p>where <span>$s[i] = +1$</span> if  <span>$v[i] \geq 0$</span> and <span>$s[i] = -1$</span> if  <span>$v [i] \leq 0$</span>, and <span>$Ac$</span> represents the resulting corrected antidiffusive flux. This formulation is based on [<a href="../references/#BorisBook1973">3</a>], as reported in [<a href="../references/#durran2010">4</a>] section 5.4.1.</p><p>Supported boundary conditions are:</p><ul><li><a href="#ClimaCore.Operators.FirstOrderOneSided"><code>FirstOrderOneSided(x‚ÇÄ)</code></a>: uses the first-order downwind reconstruction to compute <code>x</code> on the left boundary, and the first-order upwind reconstruction to compute <code>x</code> on the right boundary.</li></ul><div class="admonition is-info" id="Note-b3e42d0037093fe8"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-b3e42d0037093fe8" title="Permalink"></a></header><div class="admonition-body"><p>Similar to the <a href="#ClimaCore.Operators.Upwind3rdOrderBiasedProductC2F"><code>Upwind3rdOrderBiasedProductC2F</code></a> operator, these boundary conditions do not define the value at the actual boundary faces, and so this operator cannot be materialized directly: it needs to be composed with another operator that does not make use of this value, e.g. a <a href="#ClimaCore.Operators.DivergenceF2C"><code>DivergenceF2C</code></a> operator, with a <a href="#ClimaCore.Operators.SetValue"><code>SetValue</code></a> boundary.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L1816-L1848">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.FCTZalesak" href="#ClimaCore.Operators.FCTZalesak"><code>ClimaCore.Operators.FCTZalesak</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">U = FCTZalesak(;boundaries)
U.(A, Œ¶, Œ¶·µó·µà)</code></pre><p>Correct the flux using the flux-corrected transport formulation by Zalesak [<a href="../references/#zalesak1979fully">5</a>].</p><p>Input arguments:</p><ul><li>a face-valued vector field <code>A</code></li><li>a center-valued field <code>Œ¶</code></li><li>a center-valued field <code>Œ¶·µó·µà</code></li></ul><p class="math-container">\[Œ¶_j^{n+1} = Œ¶_j^{td} - (C_{j+\frac{1}{2}}A_{j+\frac{1}{2}} - C_{j-\frac{1}{2}}A_{j-\frac{1}{2}})\]</p><p>This stencil is based on [<a href="../references/#zalesak1979fully">5</a>], as reported in [<a href="../references/#durran2010">4</a>] section 5.4.2, where <span>$C$</span> denotes the corrected antidiffusive flux.</p><p>Supported boundary conditions are:</p><ul><li><a href="#ClimaCore.Operators.FirstOrderOneSided"><code>FirstOrderOneSided(x‚ÇÄ)</code></a>: uses the first-order downwind reconstruction to compute <code>x</code> on the left boundary, and the first-order upwind reconstruction to compute <code>x</code> on the right boundary.</li></ul><div class="admonition is-info" id="Note-b3e42d0037093fe8"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-b3e42d0037093fe8" title="Permalink"></a></header><div class="admonition-body"><p>Similar to the <a href="#ClimaCore.Operators.Upwind3rdOrderBiasedProductC2F"><code>Upwind3rdOrderBiasedProductC2F</code></a> operator, these boundary conditions do not define the value at the actual boundary faces, and so this operator cannot be materialized directly: it needs to be composed with another operator that does not make use of this value, e.g. a <a href="#ClimaCore.Operators.DivergenceF2C"><code>DivergenceF2C</code></a> operator, with a <a href="#ClimaCore.Operators.SetValue"><code>SetValue</code></a> boundary.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L1955-L1986">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.LinVanLeerC2F" href="#ClimaCore.Operators.LinVanLeerC2F"><code>ClimaCore.Operators.LinVanLeerC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinVanLeerC2F</code></pre><p>Following the van Leer class of limiters as noted in[<a href="../references/#Lin1994">6</a>], four limiter constraint options are provided for use with advection operators:</p><ul><li><code>AlgebraicMean</code>: Algebraic mean, this guarantees neither positivity nor monotonicity (eq 2, <code>avg</code>)</li><li><code>PositiveDefinite</code>: Positive-definite with implicit diffusion based on local stencil extrema (eq 3b, 3c, 5a, 5b, <code>posd</code>)</li><li><code>MonotoneHarmonic</code>: Monotonicity preserving harmonic mean, this implies a strong monotonicity constraint (eq 4, <code>mono4</code>)</li><li><code>MonotoneLocalExtrema</code>: Monotonicity preserving, with extrema bounded by the edge cells in the stencil (eq 5, <code>mono5</code>)</li></ul><p>The diffusion implied by these methods is proportional to the local upwind CFL number. The <code>mismatch</code> Œîùúô = 0 returns the first-order upwind method. Special cases (discussed in Lin et al (1994)) include setting the ùúô<em>min = 0 or ùúô</em>max = saturation mixing ratio for water vapor are not considered here in favour of the generalized local extrema in equation (5a, 5b).</p><p>Supported boundary conditions include:</p><ul><li><a href="#ClimaCore.Operators.FirstOrderOneSided"><code>FirstOrderOneSided</code></a></li><li><a href="#ClimaCore.Operators.ThirdOrderOneSided"><code>ThirdOrderOneSided</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L1428-L1453">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.LeftBiasedC2F" href="#ClimaCore.Operators.LeftBiasedC2F"><code>ClimaCore.Operators.LeftBiasedC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">L = LeftBiasedC2F(;boundaries)
L.(x)</code></pre><p>Interpolate a center-value field to a face-valued field from the left.</p><p class="math-container">\[L(x)[i] = x[i-\tfrac{1}{2}]\]</p><p>Only the left boundary condition should be set. Currently supported is:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: set the value to be <code>x‚ÇÄ</code> on the boundary.</li></ul><p class="math-container">\[L(x)[\tfrac{1}{2}] = x_0\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L582-L596">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.RightBiasedC2F" href="#ClimaCore.Operators.RightBiasedC2F"><code>ClimaCore.Operators.RightBiasedC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">R = RightBiasedC2F(;boundaries)
R.(x)</code></pre><p>Interpolate a center-valued field to a face-valued field from the right.</p><p class="math-container">\[R(x)[i] = x[i+\tfrac{1}{2}]\]</p><p>Only the right boundary condition should be set. Currently supported is:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: set the value to be <code>x‚ÇÄ</code> on the boundary.</li></ul><p class="math-container">\[R(x)[n+\tfrac{1}{2}] = x_0\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L838-L852">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.LeftBiasedF2C" href="#ClimaCore.Operators.LeftBiasedF2C"><code>ClimaCore.Operators.LeftBiasedF2C</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">L = LeftBiasedF2C(;boundaries)
L.(x)</code></pre><p>Interpolate a face-value field to a center-valued field from the left.</p><p class="math-container">\[L(x)[i+\tfrac{1}{2}] = x[i]\]</p><p>Only the left boundary condition should be set. Currently supported is:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: set the value to be <code>x‚ÇÄ</code> on the boundary.</li></ul><p class="math-container">\[L(x)[1] = x_0\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L643-L657">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.RightBiasedF2C" href="#ClimaCore.Operators.RightBiasedF2C"><code>ClimaCore.Operators.RightBiasedF2C</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">R = RightBiasedF2C(;boundaries)
R.(x)</code></pre><p>Interpolate a face-valued field to a center-valued field from the right.</p><p class="math-container">\[R(x)[i] = x[i+\tfrac{1}{2}]\]</p><p>Only the right boundary condition should be set. Currently supported is:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: set the value to be <code>x‚ÇÄ</code> on the boundary.</li></ul><p class="math-container">\[R(x)[n+\tfrac{1}{2}] = x_0\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L899-L913">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.AbstractTVDSlopeLimiter" href="#ClimaCore.Operators.AbstractTVDSlopeLimiter"><code>ClimaCore.Operators.AbstractTVDSlopeLimiter</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractTVDSlopeLimiter</code></pre><p>An asbtract TVD-slope limiter type. Use <code>subtypes(AbstractTVDSlopeLimiter)</code> to see the supported subtypes. See</p><p><code>TVDLimitedFluxC2F</code> for the general formulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L2148-L2155">source</a></section></article><h3 id="Derivative-operators"><a class="docs-heading-anchor" href="#Derivative-operators">Derivative operators</a><a id="Derivative-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Derivative-operators" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.GradientF2C" href="#ClimaCore.Operators.GradientF2C"><code>ClimaCore.Operators.GradientF2C</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">G = GradientF2C(;boundaryname=boundarycondition...)
G.(x)</code></pre><p>Compute the gradient of a face-valued field <code>x</code>, returning a center-valued <code>Covariant3</code> vector field, using the stencil:</p><p class="math-container">\[G(x)[i]^3 = x[i+\tfrac{1}{2}] - x[i-\tfrac{1}{2}]\]</p><p>We note that the usual division factor <span>$1 / \Delta z$</span> that appears in a first-order finite difference operator is accounted for in the <code>LocalVector</code> basis. Hence, users need to cast the output of the <code>GradientF2C</code> to a <code>UVector</code>, <code>VVector</code> or <code>WVector</code>, according to the type of domain on which the operator is defined.</p><p>The following boundary conditions are supported:</p><ul><li>by default, the value of <code>x</code> at the boundary face will be used.</li><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: calculate the gradient assuming the value at the boundary is <code>x‚ÇÄ</code>. For the left boundary, this becomes:</li></ul><p class="math-container">\[G(x)[1]¬≥ = x[1+\tfrac{1}{2}] - x‚ÇÄ\]</p><ul><li><a href="#ClimaCore.Operators.Extrapolate"><code>Extrapolate()</code></a>: set the value at the center closest to the boundary</li></ul><p>to be the same as the neighbouring interior value. For the left boundary, this becomes:</p><p class="math-container">\[G(x)[1]¬≥ = G(x)[2]¬≥\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L2859-L2886">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.GradientC2F" href="#ClimaCore.Operators.GradientC2F"><code>ClimaCore.Operators.GradientC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">G = GradientC2F(;boundaryname=boundarycondition...)
G.(x)</code></pre><p>Compute the gradient of a center-valued field <code>x</code>, returning a face-valued <code>Covariant3</code> vector field, using the stencil:</p><p class="math-container">\[G(x)[i]^3 = x[i+\tfrac{1}{2}] - x[i-\tfrac{1}{2}]\]</p><p>The following boundary conditions are supported:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(x‚ÇÄ)</code></a>: calculate the gradient assuming the value at the boundary is <code>x‚ÇÄ</code>. For the left boundary, this becomes:<p class="math-container">\[G(x)[\tfrac{1}{2}]¬≥ = 2 (x[1] - x‚ÇÄ)\]</p></li><li><a href="#ClimaCore.Operators.SetGradient"><code>SetGradient(v‚ÇÄ)</code></a>: set the value of the gradient at the boundary to be <code>v‚ÇÄ</code>. For the left boundary, this becomes:<p class="math-container">\[G(x)[\tfrac{1}{2}] = v‚ÇÄ\]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L2977-L2998">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.AdvectionF2F" href="#ClimaCore.Operators.AdvectionF2F"><code>ClimaCore.Operators.AdvectionF2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">A = AdvectionF2F(;boundaries)
A.(v, Œ∏)</code></pre><p>Vertical advection operator at cell faces, for a face-valued velocity field <code>v</code> and face-valued variables <code>Œ∏</code>, approximating <span>$v^3 \partial_3 \theta$</span>.</p><p>It uses the following stencil</p><p class="math-container">\[A(v,Œ∏)[i] = \frac{1}{2} (Œ∏[i+1] - Œ∏[i-1]) v¬≥[i]\]</p><p>No boundary conditions are currently supported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L2395-L2408">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.AdvectionC2C" href="#ClimaCore.Operators.AdvectionC2C"><code>ClimaCore.Operators.AdvectionC2C</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">A = AdvectionC2C(;boundaries)
A.(v, Œ∏)</code></pre><p>Vertical advection operator at cell centers, for cell face velocity field <code>v</code> cell center variables <code>Œ∏</code>, approximating <span>$v^3 \partial_3 \theta$</span>.</p><p>It uses the following stencil</p><p class="math-container">\[A(v,Œ∏)[i] = \frac{1}{2} \{ (Œ∏[i+1] - Œ∏[i]) v¬≥[i+\tfrac{1}{2}] + (Œ∏[i] - Œ∏[i-1])v¬≥[i-\tfrac{1}{2}]\}\]</p><p>Supported boundary conditions:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(Œ∏‚ÇÄ)</code></a>: set the value of <code>Œ∏</code> at the boundary face to be <code>Œ∏‚ÇÄ</code>. At the lower boundary, this is:</li></ul><p class="math-container">\[A(v,Œ∏)[1] = \frac{1}{2} \{ (Œ∏[2] - Œ∏[1]) v¬≥[1 + \tfrac{1}{2}] + (Œ∏[1] - Œ∏‚ÇÄ)v¬≥[\tfrac{1}{2}]\}\]</p><ul><li><a href="#ClimaCore.Operators.Extrapolate"><code>Extrapolate</code></a>: use the closest interior point as the boundary value. At the lower boundary, this is:</li></ul><p class="math-container">\[A(v,Œ∏)[1] = (Œ∏[2] - Œ∏[1]) v¬≥[1 + \tfrac{1}{2}] \}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L2444-L2468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.DivergenceF2C" href="#ClimaCore.Operators.DivergenceF2C"><code>ClimaCore.Operators.DivergenceF2C</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">D = DivergenceF2C(;boundaryname=boundarycondition...)
D.(v)</code></pre><p>Compute the vertical contribution to the divergence of a face-valued field vector <code>v</code>, returning a center-valued scalar field, using the stencil</p><p class="math-container">\[D(v)[i] = (Jv¬≥[i+\tfrac{1}{2}] - Jv¬≥[i-\tfrac{1}{2}]) / J[i]\]</p><p>where <code>Jv¬≥</code> is the Jacobian multiplied by the third contravariant component of <code>v</code>.</p><p>The following boundary conditions are supported:</p><ul><li>by default, the value of <code>v</code> at the boundary face will be used.</li><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(v‚ÇÄ)</code></a>: calculate the divergence assuming the value at the boundary is <code>v‚ÇÄ</code>. For the left boundary, this becomes:</li></ul><p class="math-container">\[D(v)[1] = (Jv¬≥[1+\tfrac{1}{2}] - Jv¬≥‚ÇÄ) / J[i]\]</p><ul><li><a href="#ClimaCore.Operators.Extrapolate"><code>Extrapolate()</code></a>: set the value at the center closest to the boundary to be the same as the neighbouring interior value. For the left boundary, this becomes:</li></ul><p>```math D(v)[1]¬≥ = D(v)[2]¬≥</p><ul><li><a href="#ClimaCore.Operators.SetDivergence"><code>SetDivergence(v‚ÇÄ)</code></a>: set the divergence at the cell center  closest to the boundary</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L3194-L3222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.DivergenceC2F" href="#ClimaCore.Operators.DivergenceC2F"><code>ClimaCore.Operators.DivergenceC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">D = DivergenceC2F(;boundaryname=boundarycondition...)
D.(v)</code></pre><p>Compute the vertical contribution to the divergence of a center-valued field vector <code>v</code>, returning a face-valued scalar field, using the stencil</p><p class="math-container">\[D(v)[i] = (Jv¬≥[i+\tfrac{1}{2}] - Jv¬≥[i-\tfrac{1}{2}]) / J[i]\]</p><p>where <code>Jv¬≥</code> is the Jacobian multiplied by the third contravariant component of <code>v</code>.</p><p>The following boundary conditions are supported:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(v‚ÇÄ)</code></a>: calculate the divergence assuming the value at the  boundary is <code>v‚ÇÄ</code>. For the left boundary, this becomes:<p class="math-container">\[D(v)[\tfrac{1}{2}] = \frac{1}{2} (Jv¬≥[1] - Jv¬≥‚ÇÄ) / J[i]\]</p></li><li><a href="#ClimaCore.Operators.SetDivergence"><code>SetDivergence(x)</code></a>: set the value of the divergence at the boundary to be <code>x</code>.<p class="math-container">\[D(v)[\tfrac{1}{2}] = x\]</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L3376-L3398">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.CurlC2F" href="#ClimaCore.Operators.CurlC2F"><code>ClimaCore.Operators.CurlC2F</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">C = CurlC2F(;boundaryname=boundarycondition...)
C.(v)</code></pre><p>Compute the vertical-derivative contribution to the curl of a center-valued covariant vector field <code>v</code>. It acts on the horizontal covariant components of <code>v</code> (that is it only depends on <span>$v‚ÇÅ$</span> and <span>$v‚ÇÇ$</span>), and will return a face-valued horizontal contravariant vector field (that is <span>$C(v)¬≥ = 0$</span>).</p><p>Specifically it approximates:</p><p class="math-container">\[\begin{align*}
C(v)^1 &amp;= -\frac{1}{J} \frac{\partial v_2}{\partial \xi^3}  \\
C(v)^2 &amp;= \frac{1}{J} \frac{\partial v_1}{\partial \xi^3} \\
\end{align*}\]</p><p>using the stencils</p><p class="math-container">\[\begin{align*}
C(v)[i]^1 &amp;= - \frac{1}{J[i]} (v‚ÇÇ[i+\tfrac{1}{2}] - v‚ÇÇ[i-\tfrac{1}{2}]) \\
C(v)[i]^2 &amp;= \frac{1}{J[i]}  (v‚ÇÅ[i+\tfrac{1}{2}] - v‚ÇÅ[i-\tfrac{1}{2}])
\end{align*}\]</p><p>where <span>$v‚ÇÅ$</span> and <span>$v‚ÇÇ$</span> are the 1st and 2nd covariant components of <span>$v$</span>, and <span>$J$</span> is the Jacobian determinant.</p><p>The following boundary conditions are supported:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(v‚ÇÄ)</code></a>: calculate the curl assuming the value of <span>$v$</span> at the  boundary is <code>v‚ÇÄ</code>. For the left boundary, this becomes:<p class="math-container">\[C(v)[\tfrac{1}{2}]^1 = -\frac{2}{J[i]} (v_2[1] - (v‚ÇÄ)_2)
C(v)[\tfrac{1}{2}]^2 = \frac{2}{J[i]} (v_1[1] - (v‚ÇÄ)_1)\]</p></li><li><a href="#ClimaCore.Operators.SetCurl"><code>SetCurl(v‚Å∞)</code></a>: enforce the curl operator output at the boundary to be the contravariant vector <code>v‚Å∞</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L3505-L3541">source</a></section></article><h3 id="Other"><a class="docs-heading-anchor" href="#Other">Other</a><a id="Other-1"></a><a class="docs-heading-anchor-permalink" href="#Other" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.SetBoundaryOperator" href="#ClimaCore.Operators.SetBoundaryOperator"><code>ClimaCore.Operators.SetBoundaryOperator</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SetBoundaryOperator(;boundaries...)</code></pre><p>This operator only modifies the values at the boundary:</p><ul><li><a href="#ClimaCore.Operators.SetValue"><code>SetValue(val)</code></a>: set the value to be <code>val</code> on the boundary.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L2800-L2806">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.FirstOrderOneSided" href="#ClimaCore.Operators.FirstOrderOneSided"><code>ClimaCore.Operators.FirstOrderOneSided</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FirstOrderOneSided()</code></pre><p>Use a first-order up/down-wind scheme to compute the value at the boundary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L143-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.ThirdOrderOneSided" href="#ClimaCore.Operators.ThirdOrderOneSided"><code>ClimaCore.Operators.ThirdOrderOneSided</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ThirdOrderOneSided()</code></pre><p>Use a third-order up/down-wind scheme to compute the value at the boundary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L150-L154">source</a></section></article><h2 id="Finite-difference-boundary-conditions"><a class="docs-heading-anchor" href="#Finite-difference-boundary-conditions">Finite difference boundary conditions</a><a id="Finite-difference-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-difference-boundary-conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.AbstractBoundaryCondition" href="#ClimaCore.Operators.AbstractBoundaryCondition"><code>ClimaCore.Operators.AbstractBoundaryCondition</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractBoundaryCondition</code></pre><p>An abstract type for boundary conditions for <a href="#ClimaCore.Operators.FiniteDifferenceOperator"><code>FiniteDifferenceOperator</code></a>s.</p><p>Subtypes should define:</p><ul><li><a href="#ClimaCore.Operators.boundary_width"><code>boundary_width</code></a></li><li><a href="#ClimaCore.Operators.stencil_left_boundary"><code>stencil_left_boundary</code></a></li><li><a href="#ClimaCore.Operators.stencil_right_boundary"><code>stencil_right_boundary</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L75-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.SetCurl" href="#ClimaCore.Operators.SetCurl"><code>ClimaCore.Operators.SetCurl</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SetCurl(val)</code></pre><p>Set the curl at the boundary to be <code>val</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L127-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.SetValue" href="#ClimaCore.Operators.SetValue"><code>ClimaCore.Operators.SetValue</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SetValue(val)</code></pre><p>Set the value at the boundary to be <code>val</code>. In the case of gradient operators, this will set the input value from which the gradient is computed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L98-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.SetGradient" href="#ClimaCore.Operators.SetGradient"><code>ClimaCore.Operators.SetGradient</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SetGradient(val)</code></pre><p>Set the gradient at the boundary to be <code>val</code>. In the case of gradient operators this will set the output value of the gradient.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L108-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.SetDivergence" href="#ClimaCore.Operators.SetDivergence"><code>ClimaCore.Operators.SetDivergence</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SetDivergence(val)</code></pre><p>Set the divergence at the boundary to be <code>val</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L118-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.Extrapolate" href="#ClimaCore.Operators.Extrapolate"><code>ClimaCore.Operators.Extrapolate</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Extrapolate()</code></pre><p>Set the value at the boundary to be the same as the closest interior point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L136-L140">source</a></section></article><h2 id="Integrals"><a class="docs-heading-anchor" href="#Integrals">Integrals</a><a id="Integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Integrals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.column_integral_definite!" href="#ClimaCore.Operators.column_integral_definite!"><code>ClimaCore.Operators.column_integral_definite!</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">column_integral_definite!(œï_top, ·∂ú‚àÇœï‚àÇz, [œï_bot])</code></pre><p>Sets <code>œï_top</code><span>${}= \frac{1}{ŒîA(z_{bot})}\int_{z_{bot}}^{z_{top}}\,$</span><code>·∂ú‚àÇœï‚àÇz</code><span>$(z)\,ŒîA(z)\,dz +{}$</span><code>œï_bot</code>, where <span>$z_{bot}$</span> and <span>$z_{top}$</span> are the values of <code>z</code> at the bottom and top of the domain, and where <code>ŒîA</code> is the area differential <code>J/Œîz</code>, with <code>J</code> denoting the metric Jacobian. The input <code>·∂ú‚àÇœï‚àÇz</code> should be a cell-center <code>Field</code> or <code>AbstractBroadcasted</code>, and the output <code>œï_top</code> should be a horizontal <code>Field</code>. The default value of <code>œï_bot</code> is 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/integrals.jl#L5-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.column_integral_indefinite!" href="#ClimaCore.Operators.column_integral_indefinite!"><code>ClimaCore.Operators.column_integral_indefinite!</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">column_integral_indefinite!(·∂†œï, ·∂ú‚àÇœï‚àÇz, [œï_bot])</code></pre><p>Sets <code>·∂†œï</code><span>$(z) = \frac{1}{ŒîA(z_{bot})}\int_{z_{bot}}^z\,$</span><code>·∂ú‚àÇœï‚àÇz</code><span>$(z&#39;)\, ŒîA(z&#39;)\,dz&#39; +{}$</span><code>œï_bot</code>, where <span>$z_{bot}$</span> is the value of <code>z</code> at the bottom of the domain, and where <code>ŒîA</code> is the area differential <code>J/Œîz</code>, with <code>J</code> denoting the metric Jacobian. The input <code>·∂ú‚àÇœï‚àÇz</code> should be a cell-center <code>Field</code> or <code>AbstractBroadcasted</code>, and the output <code>·∂†œï</code> should be a cell-face <code>Field</code>. The default value of <code>œï_bot</code> is 0.</p><pre><code class="nohighlight hljs">column_integral_indefinite!(‚àÇœï‚àÇz, ·∂†œï, [œï_bot], [rtol])</code></pre><p>Sets <code>·∂†œï</code><span>$(z) = \frac{1}{ŒîA(z_{bot})}\int_{z_{bot}}^z\,$</span><code>‚àÇœï‚àÇz</code><span>$($</span><code>·∂†œï</code><span>$(z&#39;), z&#39;)\,ŒîA(z&#39;)\,dz&#39; +{}$</span><code>œï_bot</code>, where <code>‚àÇœï‚àÇz</code> can be any scalar-valued two-argument function. When a shallow atmosphere approximation is used, <code>ŒîA = ŒîA_{bot}</code> at all values of <code>z</code>, and the output <code>·∂†œï</code> satisfies <code>·∂úgrad·µ•.(·∂†œï) ‚âà ‚àÇœï‚àÇz.(·∂úint.(·∂†œï), ·∂úz)</code> with a relative tolerance of <code>rtol</code>, where <code>·∂úgrad·µ• = GradientF2C()</code> and <code>·∂úint = InterpolateF2C()</code>. When a deep atmosphere is used, the vertical gradient is replaced with an area-weighted gradient. The default value of <code>œï_bot</code> is 0, and the default value of <code>rtol</code> is 0.001.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/integrals.jl#L25-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.column_reduce!" href="#ClimaCore.Operators.column_reduce!"><code>ClimaCore.Operators.column_reduce!</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">column_reduce!(f, output, input; [init], [transform])</code></pre><p>Applies <code>reduce</code> to <code>input</code> along the vertical direction, storing the result in <code>output</code>. The <code>input</code> can be either a <code>Field</code> or an <code>AbstractBroadcasted</code> that performs pointwise or columnwise operations on <code>Field</code>s. Each reduced value is computed by iteratively applying <code>f</code> to the values in <code>input</code>, starting from the bottom of each column and moving upward, and the result of the final iteration is passed to the <code>transform</code> function before being stored in <code>output</code>. If <code>init</code> is specified, it is used as the initial value of the iteration; otherwise, the value at the bottom of each column in <code>input</code> is used as the initial value.</p><p>With <code>first_level</code> and <code>last_level</code> denoting the indices of the boundary levels of <code>input</code>, the reduction in each column can be summarized as follows:</p><ul><li>If <code>init</code> is unspecified,<pre><code class="nohighlight hljs">reduced_value = input[first_level]
for level in (first_level + 1):last_level
    reduced_value = f(reduced_value, input[level])
end
output[] = transform(reduced_value)</code></pre></li><li>If <code>init</code> is specified,<pre><code class="nohighlight hljs">reduced_value = init
for level in first_level:last_level
    reduced_value = f(reduced_value, input[level])
end
output[] = transform(reduced_value)</code></pre></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/integrals.jl#L108-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.column_accumulate!" href="#ClimaCore.Operators.column_accumulate!"><code>ClimaCore.Operators.column_accumulate!</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">column_accumulate!(f, output, input; [init], [transform])</code></pre><p>Applies <code>accumulate</code> to <code>input</code> along the vertical direction, storing the result in <code>output</code>. The <code>input</code> can be either a <code>Field</code> or an <code>AbstractBroadcasted</code> that performs pointwise or columnwise operations on <code>Field</code>s. Each accumulated value is computed by iteratively applying <code>f</code> to the values in <code>input</code>, starting from the bottom of each column and moving upward, and the result of each iteration is passed to the <code>transform</code> function before being stored in <code>output</code>. The <code>init</code> value is is optional for center-to-center, face-to-face, and face-to-center accumulation, but it is required for center-to-face accumulation.</p><p>With <code>first_level</code> and <code>last_level</code> denoting the indices of the boundary levels of <code>input</code>, the accumulation in each column can be summarized as follows:</p><ul><li>For center-to-center and face-to-face accumulation with <code>init</code> unspecified,<pre><code class="nohighlight hljs">accumulated_value = input[first_level]
output[first_level] = transform(accumulated_value)
for level in (first_level + 1):last_level
    accumulated_value = f(accumulated_value, input[level])
    output[level] = transform(accumulated_value)
end</code></pre></li><li>For center-to-center and face-to-face accumulation with <code>init</code> specified,<pre><code class="nohighlight hljs">accumulated_value = init
for level in first_level:last_level
    accumulated_value = f(accumulated_value, input[level])
    output[level] = transform(accumulated_value)
end</code></pre></li><li>For face-to-center accumulation with <code>init</code> unspecified,<pre><code class="nohighlight hljs">accumulated_value = input[first_level]
for level in (first_level + 1):last_level
    accumulated_value = f(accumulated_value, input[level])
    output[level - half] = transform(accumulated_value)
end</code></pre></li><li>For face-to-center accumulation with <code>init</code> specified,<pre><code class="nohighlight hljs">accumulated_value = f(init, input[first_level])
for level in (first_level + 1):last_level
    accumulated_value = f(accumulated_value, input[level])
    output[level - half] = transform(accumulated_value)
end</code></pre></li><li>For center-to-face accumulation,<pre><code class="nohighlight hljs">accumulated_value = init
output[first_level - half] = transform(accumulated_value)
for level in first_level:last_level
    accumulated_value = f(accumulated_value, input[level])
    output[level + half] = transform(accumulated_value)
end</code></pre></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/integrals.jl#L206-L262">source</a></section></article><h2 id="Internal-APIs"><a class="docs-heading-anchor" href="#Internal-APIs">Internal APIs</a><a id="Internal-APIs-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-APIs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.getidx_return_type" href="#ClimaCore.Operators.getidx_return_type"><code>ClimaCore.Operators.getidx_return_type</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">getidx_return_type(::Base.Broadcasted)
getidx_return_type(::StencilBroadcasted)
getidx_return_type(::Field)
getidx_return_type(::Any)
...</code></pre><p>The return type of <code>getidx</code> on the arguemnt. Defaults to the type of the argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L183-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.stencil_return_type" href="#ClimaCore.Operators.stencil_return_type"><code>ClimaCore.Operators.stencil_return_type</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stencil_return_type(::Op, args...)</code></pre><p>The return type of the given stencil and arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L355-L359">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.return_eltype" href="#ClimaCore.Operators.return_eltype"><code>ClimaCore.Operators.return_eltype</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">return_eltype(::Op, fields...)</code></pre><p>Defines the element type of the result of operator <code>Op</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L322-L326">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.return_space" href="#ClimaCore.Operators.return_space"><code>ClimaCore.Operators.return_space</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">return_space(::Op, spaces...)</code></pre><p>Defines the space upon which the operator <code>Op</code> returns given arguments on input <code>spaces</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/common.jl#L10-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.stencil_interior_width" href="#ClimaCore.Operators.stencil_interior_width"><code>ClimaCore.Operators.stencil_interior_width</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stencil_interior_width(::Op, args...)</code></pre><p>Defines the width of the interior stencil for the operator <code>Op</code> with the given arguments. Returns a tuple of 2-tuples: each 2-tuple should be the lower and upper bounds of the index offsets of the stencil for each argument in the stencil.</p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">stencil(::Op, arg1, arg2) = ((-half, 1+half), (0,0))</code></pre><p>implies that at index <code>i</code>, the stencil accesses <code>arg1</code> at <code>i-half</code>, <code>i+half</code> and <code>i+1+half</code>, and <code>arg2</code> at index <code>i</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L330-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.stencil_interior" href="#ClimaCore.Operators.stencil_interior"><code>ClimaCore.Operators.stencil_interior</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stencil_interior(::Op, space, idx, args...)</code></pre><p>Defines the stencil of the operator <code>Op</code> in the interior of the domain at <code>idx</code>; <code>args</code> are the input arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L347-L352">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.boundary_width" href="#ClimaCore.Operators.boundary_width"><code>ClimaCore.Operators.boundary_width</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundary_width(::Op, ::BC, args...)</code></pre><p>Defines the width of a boundary condition <code>BC</code> on an operator <code>Op</code>. This is the number of locations that are used in a modified stencil. Either this function, or <a href="#ClimaCore.Operators.left_interior_idx"><code>left_interior_idx</code></a> and <a href="#ClimaCore.Operators.right_interior_idx"><code>right_interior_idx</code></a> should be defined for a specific <code>Op</code>/<code>BC</code> combination.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L363-L370">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.stencil_left_boundary" href="#ClimaCore.Operators.stencil_left_boundary"><code>ClimaCore.Operators.stencil_left_boundary</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stencil_left_boundary(::Op, ::BC, idx, args...)</code></pre><p>Defines the stencil of operator <code>Op</code> at <code>idx</code> near the left boundary, with boundary condition <code>BC</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L373-L377">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.stencil_right_boundary" href="#ClimaCore.Operators.stencil_right_boundary"><code>ClimaCore.Operators.stencil_right_boundary</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stencil_right_boundary(::Op, ::BC, idx, args...)</code></pre><p>Defines the stencil of operator <code>Op</code> at <code>idx</code> near the right boundary, with boundary condition <code>BC</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L380-L384">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.left_interior_idx" href="#ClimaCore.Operators.left_interior_idx"><code>ClimaCore.Operators.left_interior_idx</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">left_interior_idx(space::AbstractSpace, op::FiniteDifferenceOperator, bc::AbstractBoundaryCondition, args..)</code></pre><p>The index of the left-most interior point of the operator <code>op</code> with boundary <code>bc</code> when used with arguments <code>args...</code>. By default, this is</p><pre><code class="language-julia hljs">left_idx(space) + boundary_width(op, bc)</code></pre><p>but can be overwritten for specific stencil types (e.g. if the stencil is assymetric).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L3636-L3646">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ClimaCore.Operators.right_interior_idx" href="#ClimaCore.Operators.right_interior_idx"><code>ClimaCore.Operators.right_interior_idx</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">right_interior_idx(space::AbstractSpace, op::FiniteDifferenceOperator, bc::AbstractBoundaryCondition, args..)</code></pre><p>The index of the right-most interior point of the operator <code>op</code> with boundary <code>bc</code> when used with arguments <code>args...</code>. By default, this is</p><pre><code class="language-julia hljs">right_idx(space) + boundary_width(op, bc)</code></pre><p>but can be overwritten for specific stencil types (e.g. if the stencil is assymetric).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaCore.jl/blob/5c87a364933e2bc8019bfb4a98fae478e3a0b08b/src/Operators/finitedifference.jl#L3656-L3666">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../geometry/">¬´ Geometry</a><a class="docs-footer-nextpage" href="../remapping/">Remapping ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Monday 27 October 2025 18:05">Monday 27 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
